
#------------------------------------------------------------------------------
# $File: pdf,v 1.16 2021/07/30 11:47:07 christos Exp $
# pdf:  file(1) magic for Portable Document Format
#


# Each Line specifies a test to be performed
# test compares the data starting at a particular offset in the file,
# whith a byte value, string or a numeric value. If the test succeeds, msg is printed


# Line consist of following fields:
# offset, a number specifying the offset
# type, type of the data to be tested; byte, short, long, string etc https://man7.org/linux/man-pages/man4/magic.4.html
# test, the value to be compared with the value from the file. value is specified in C form
#         = value from the file must equal the specified value
#         < less then > greater then
#         * should have set of all bits
#         if character omitted, it is assumed to be =.
#                   C form number: 13 is decimal, 013 is octal, and 0x13 is hexadecimal
#
# message, the message to be printed.

# Test levels,
# A line with no > at the beginning is considered to be at level 0
# First all test at level 0 must succeed for test at level 1 to be performed
#

# Two types of test, text or binary,
# regex search text test
# all other binary

## at offset 0, name(I dont understand), =
0	name	pdf
>8	search		/Count
>>&0	regex		[0-9]+		\b, %s pages
>8	search/512	/Filter/FlateDecode/	(zip deflate encoded)

# offset 0,
# type = string refers to "sequences of printable characters in file
#           at least 4 char long and followed by an unprintable character
# = "%PDF-"
# Print message PDF document
0	string		%PDF-		PDF document
!:mime	application/pdf
!:strength +60
!:ext	pdf
>5	byte		x		\b, version %c
>7	byte		x		\b.%c
>0	use		pdf


0	string		\012%PDF-	PDF document
!:mime	application/pdf
!:strength +60
!:ext	pdf
>6	byte		x		\b, version %c
>8	byte		x		\b.%c
>0	use		pdf

0	string		\xef\xbb\xbf%PDF-	PDF document (UTF-8)
!:mime	application/pdf
!:strength +60
!:ext	pdf
>6	byte		x		\b, version %c
>8	byte		x		\b.%c
>0	use		pdf

# From: Nick Schmalenberger <nick@schmalenberger.us>
# Forms Data Format
0       string          %FDF-           FDF document
!:mime application/vnd.fdf
!:strength +60
!:ext	pdf
>5      byte            x               \b, version %c
>7      byte            x               \b.%c

0	search/256	%PDF-		PDF document
!:mime	application/pdf
!:strength +60
!:ext	pdf
>&0	byte		x		\b, version %c
>&2	byte		x		\b.%c
>0	use		pdf
